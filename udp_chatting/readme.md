## 11. UDP CHAT SERVER

<br>

### κ°λ° κ²°κ³Όλ¬Ό

- udpλ¥Ό μ‚¬μ©ν•μ—¬ μ„λ²„μ— μ—°κ²°λ ν΄λΌμ΄μ–ΈνΈλ“¤ μ‚¬μ΄μ— μ±„ν…μ„ μν–‰ν•λ‹¤.
- μ±„ν…μ„ ν•λ” κ³Όμ •μ—μ„ UDP μ΄λ―€λ΅ μ—°κ²°μ§€ν–¥μ΄ μ•„λ‹κΈ° λ•λ¬Έμ— `#REG` λΌλ” μ„μμ κ·μΉ™μ„ ν†µν•΄ μ‚¬μ©μλ¥Ό λ“±λ΅ν•λ‹¤.

<br>

### μ†μ¤μ½”λ“ μ†κ°

π‘€ μ½”λ“ μƒμ μ£Όμ„μΌλ΅ μ„¤λ…λμ–΄ μμΌλ―€λ΅ ν•µμ‹¬μ΄λΌ μƒκ°λλ” κ²ƒλ§ κ°„λµν•κ² μ†κ°

- μ΄μ „ `lec-03-prg-10-udp-echo-server-socketserver.js` μ™€ λΉ„κµν•μ—¬ ν•µμ‹¬μΈ λ¶€λ¶„μ€ clientλ¥Ό κ΄€λ¦¬ν•λ” λ¶€λ¶„μ΄λΌ μƒκ°ν•λ‹¤.
- UDPλ” μ—°κ²°μ§€ν–¥μ΄ μ•„λ‹λ―€λ΅ μ„μ—μ„ μ–ΈκΈ‰ν•λ€λ΅ `#REG` λΌλ” μ„μμ κ·μΉ™μ„ ν†µν•΄ μ‚¬μ©μλ¥Ό λ“±λ΅ν•λ‹¤.

  ```js
  if (msg.toString() === "#REG") {
    // κµ¬λ¶„ν• λ–„ address λ§μΌλ΅λ” μ μΌν•κ² μ‹λ³„μ΄ λ¶κ°€λ¥ν•κΈ° λ–„λ¬Έμ— port λ²νΈλ„ ν•¨κ» μ €μ¥ν•΄μ¤€λ‹¤.
    clientQueue.push({ address: info.address, port: info.port });
  }
  ```

- `#DEREG`λ¥Ό ν†µν•΄ μ‚¬μ©μ λ“±λ΅μ„ ν•΄μ ν•λ‹¤.

  ```js
    else if (msg.toString() === "#DEREG" || msg.toString() === "quit") {
      // λ©λ΅μ—μ„ ν„μ¬ λ©”μ‹μ§€λ¥Ό λ³΄λ‚Έ μ†μΌ“μ μ •λ³΄μ™€ μΌμΉν•λ” client indexλ¥Ό μ°Ύλ”λ‹¤.
      const clinetIndex = clientQueue.findIndex(
        (item) => item.address === info.address && item.port === info.port
      );
      // μ°Ύμ•λ‹¤λ©΄ μ κ±°ν•λ‹¤.
      if (exitSocket > -1) {
        clientQueue.splice(exitSocket, 1);
      }
    }
  ```

- λ©”μ‹μ§€λ¥Ό λ³΄λ‚Όλ–„λ„ client λ¦¬μ¤νΈ μ•μ— μλ” λ¨λ“  ν΄λΌμ΄μ–ΈνΈμ—κ² λ³΄λ‚Έλ‹¤.
  ```js
  clientQueue.map((client) => {
    server.send(msg, client.port, client.address, (err) => {});
  });
  ```

<br>

### λ°λ¨μμƒ μ†κ°

- udp μ„λ²„λ¥Ό λ™μ‘μ‹ν‚¤λ©΄ ν„μ¬ udp μ„λ²„μ— λ€ν• μ •λ³΄λ¥Ό μ¶λ ¥ν•λ‹¤.
- ν΄λΌμ΄μ–ΈνΈκ°€ ν•λ‚λ„ λ“±λ΅λμ§€ μ•μ•λ”λ° λ©”μ‹μ§€λ¥Ό μ „μ†΅ν•κ² λλ©΄, λ“±λ΅λ ν΄λΌμ΄μ–ΈνΈκ°€ μ—†λ‹¤λ” λ©”μ‹μ§€λ¥Ό μ¶λ ¥ν•λ‹¤.

- μ΄ν›„ ν΄λΌμ΄μ–ΈνΈκ°€ #REG λ©”μ‹μ§€λ¥Ό ν†µν•΄ μ„λ²„μ— λ“±λ΅μ„ ν•λ©΄ μ„λ²„μ ν΄λΌμ΄μ–ΈνΈ λ¦¬μ¤νΈμ— μ¶”κ°€λκ³ , μ„λ²„μ— κ·Έ ν΄λΌμ΄μ–ΈνΈμ μ†μΌ“ μ •λ³΄κ°€ μ¶λ ¤λλ‹¤.

- 1λ… μ΄μƒμ΄ λ“±λ΅λμ–΄μμ„λ• μ±„ν…μ„ λ³΄λ‚΄λ©΄ μ •μƒμ μΌλ΅ μ±„ν…μ΄ λ“±λ΅λ ν΄λΌμ΄μ–ΈνΈ λ¨λ‘μ—κ² μ „λ‹¬λλ‹¤. μ΄λ• λ“±λ΅λμ§€ μ•μ€ ν΄λΌμ΄μ–ΈνΈμ—κ²λ” λ©”μ‹μ§€κ°€ μ „λ‹¬λμ§€ μ•λ”λ‹¤.

- ν•μ§€λ§ μ΄λ• λ“±λ΅λμ§€ μ•μ€ μ‚¬μ©μκ°€ μ±„ν…μ„ λ³΄λ‚΄λ©΄, λ“±λ΅λμ§€ μ•μ€ μ‚¬μ©μκ°€ λ©”μ‹μ§€λ¥Ό λ³΄λƒλ‹¤κ³  μ¶λ ¥ν•λ©°, μ΄ λ©”μ‹μ§€λ¥Ό λ‹¤λ¥Έ λ“±λ΅λ ν΄λΌμ΄μ–ΈνΈλ“¤μ—κ² μ „μ†΅ν•μ§€ μ•λ”λ‹¤.

- ν΄λΌμ΄μ–ΈνΈμ—μ„ #DEREG λλ” quit λ©”μ‹μ§€λ¥Ό μ„λ²„λ΅ λ³΄λ‚΄ μ—°κ²°μ„ μΆ…λ£λ¥Ό ν•κ²λλ©΄, μ„λ²„μ—μ„ μΆ…λ£λ ν΄λΌμ΄μ–ΈνΈμ— λ€ν• μ •λ³΄κ°€ μ¶λ ¥λλ‹¤.

- λ¨λ‘ μ—°κ²°μ΄ ν•΄μ λμ–΄λ„, μ„λ²„λ” μΆ…λ£λμ§€ μ•κ³  λ„κµ°κ°€μ μ—°κ²°μ„ κ³„μ†ν•΄μ„ κΈ°λ‹¤λ¦°λ‹¤.

  <br>

### λλ‚€μ 

- #REG, #DEREG λ“±κ³Ό κ°™μ΄ λ‚λ§μ ν”„λ΅ν† μ½μ„ μ •μν•κ³ , λ‚μ ν”„λ΅κ·Έλ¨μ—μ„ μ‚¬μ©ν•λ” κ²ƒμ„ κµ¬ν„ν•΄λ³΄λ‹ μ‹ κΈ°ν–λ‹¤.
- UDPμ™€ TCPμ μ°¨μ΄μ— λ€ν•΄ κ°κ° μ±„ν…μ„ κµ¬ν„ν•΄λ΄„μΌλ΅μ¨ λ…ν™•ν•κ² μ• μ μμ—λ‹¤.

  <br/>

---

#### π› κµ¬ν„ν• μ½”λ“μ λ‚΄μ©μ— λ€ν• μμ„Έν• μ„¤λ…μ€ js νμΌ μ•μ— μ£Όμ„μΌλ΅ μ²¨λ¶€λμ–΄μμµλ‹λ‹¤.

#### π λ”°λΌμ„ ν•µμ‹¬μ΄λΌ μƒκ°λλ” μ½”λ“λ¥Ό μ μ™Έν• λ‚λ¨Έμ§€ μ½”λ“μ— λ€ν• μμ„Έν• λ‚΄μ©μ€ ν•΄λ‹Ή readmeμ—μ„ μ μ™Έν•μ€μµλ‹λ‹¤.
